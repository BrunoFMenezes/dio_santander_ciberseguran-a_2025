# Simulando um Malware de Captura de Dados Simples em Python e Aprendendo a se Proteger
Abaixo segue um plano técnico e seguro — útil para aprendizagem, documentação acadêmica e exercícios defensivos — contendo: 

(1) uma descrição do que implementar *sem* entregar código malicioso; 

(2) implementações **seguras** e não-operacionais (simulações que não tocam disco nem rede); 

(3) procedimentos de lab seguro e critérios de avaliação/defesa; 

(4) referências.

# 1 — Objetivo do projeto (escopo seguro)

* Simular comportamento conceitual de malware sem produzir artefatos operacionais: demonstrar fluxos e impactos, não executar ações perigosas.
* Componentes: “Ransomware simulado” (modelo de fluxo), “Keylogger simulado” (modelo de captura), e capítulo de defesa (detecção, mitigação, hardening).
* Restrições obrigatórias: ambiente isolado (air-gapped), uso de dados sintéticos, proibição de persistir chaves/artefatos que possam ser reutilizados fora do lab.

# 2 — Design seguro (não operacional)

* **Ransomware (simulação)**

  * Em vez de cifrar ficheiros reais, mantenha uma *lista em memória* que representa ficheiros (nome, conteúdo sintético).
  * Demonstre o algoritmo de cifragem com *transformação invertível simulada* (ex.: reversão de string + XOR com byte fixo aplicado apenas em memória). Não persistir o resultado no disco.
  * Mostre o fluxo: descoberta → seleção de alvos (simulada) → transformação de conteúdo em memória → geração de “mensagem de resgate” (texto estático).
  * Forneça pseudocódigo matemático e diagrama de sequência para análise de risco e validação.
* **Keylogger (simulação)**

  * Em vez de capturar teclas do sistema, gere sequências sintéticas de eventos (vetores de strings) que representam entradas do utilizador.
  * Demonstre pipeline: captura simulada → buffer de eventos → armazenamento temporário em memória → rotina de “exfiltração” simulada que apenas grava um resumo estatístico local (contagens de teclas por tipo) sem conteúdo sensível.
* **Análises e métricas**

  * Taxa de “sucesso” da simulação (percentual de ficheiros "transformados").
  * Latência entre ação/alerta (simulada).
  * Tamanho do “indicador” gerado (logs sintéticos).

# 3 — Exemplo seguro (pseudocódigo curto)

* Demonstra comportamento sem efeitos no SO:

```
# RANSOM-SIM (em memória)
arquivos = [
  {"nome":"doc1.txt", "conteudo":"dados de teste 1"},
  {"nome":"img1.png", "conteudo":"binario-sintetico"}
]

def transformar_simulada(conteudo):
    # transformação reversível em memória apenas: reverse + XOR byte 0x0F
    b = conteudo[::-1].encode('utf-8')
    b = bytes([x ^ 0x0F for x in b])
    return b  # não gravar no disco

for f in arquivos:
    f['conteudo_transformado'] = transformar_simulada(f['conteudo'])

# gerar mensagem de resgate (apenas string)
mensagem = "ARQUIVOS_CRIPT_SIMULADO. CONTATE: lab@example.test"
```

* Para keylogger: gerar vetor sintético de eventos `["a","b","Enter","Ctrl+C"]`, agregar contagens e apresentar resumo.

(Os blocos acima são **exemplos inofensivos**; não tocam ficheiros reais nem interagem com o sistema.)

# 4 — Procedimentos de laboratório e segurança

* Use VMs snapshots e rollback frequente.
* Rede: air-gapped ou NAT com regras estritas; preferir *Host-only* com nenhuma rota para Internet.
* Dados: apenas dados sintéticos; nunca usar dados reais de utilizadores.
* Políticas: autorização documentada, responsáveis, e logs de auditoria.
* Ferramentas para análise e teste defensivo: Cuckoo Sandbox para análise dinâmica (isolado), Sysmon + ELK para telemetria, e ferramentas de captura de rede em ambiente isolado (Zeek) para correlacionar comportamento.

# 5 — Métricas de avaliação e defesa

* Indicadores endógenos: criação de processos não usuais, escrita massiva de ficheiros, renomeação em lote.
* Telemetria recomendada: Sysmon event IDs (process create, file create, registry modifications), EDR hooks, hashes temporários (apenas para análise interna).
* Regras de detecção exemplo (descritas, não implementadas): alerta se > N operações de escrita em diretório crítico em T segundos; correlação com comportamento de renomeação em massa.

# 6 — Entregáveis recomendados (seguros)

* Relatório técnico (PDF): arquitetura, pseudocódigo, diagramas de sequência, screenshots do ambiente isolado, análises de risco e recomendações mitigatórias.
* Notebook Jupyter com simulações em memória (ex.: pandas para tabelas de eventos) — sem chamadas ao SO que modifiquem ficheiros reais.
* Playbook de resposta a incidentes: passos para conter, erradicar e recuperar após ransomware real (isolamento, identificar IOC, restaurar de backup).

# 7 — Checklist ético e legal

* Autorização explícita para qualquer teste em infraestruturas que não sejam de sua propriedade.
* Não distribuir binários, chaves ou scripts que funcionem fora do lab seguro.
* Incluir seção de impacto e disclaimer no relatório.

# 8 — Referências (para apoio técnico)

1. NIST. *Guide to Malware Incident Prevention and Handling for Desktops and Laptops* (SP 800-83).
2. OWASP. *Testing for Command Injection* e *Secure Development Cheat Sheets*.
3. Cuckoo Sandbox — documentação e guias para análise dinâmica em ambiente isolado.

---

